name: msborkson
services:
  # # MongoDB
  # mongo-db:
  #   container_name: mongo-db
  #   image: mongo:latest
  #   restart: always
  #   volumes:
  #     - ../apps/mongodb_data:/data/db

  # # Postgres
  # postgres-db:
  #   container_name: postgres-db
  #   image: postgres:latest
  #   restart: always    
  #   environment:
  #     - POSTGRES-PASSWORD=/run/secrets/POSTGRES_PASSWORD
  #     - POSTGRES-USER=borkson
  #   volumes:
  #     - ../apps/postgres_data:/var/lib/postgresql/data
  #   secrets:
  #     - POSTGRES_PASSWORD

  # # Selenium
  # chrome:
  #   container_name: selenium
  #   image: selenium/standalone-chrome:latest
  #   restart: always
  #   hostname: chrome
  #   privileged: true
  #   shm-size: 2g

  # # server
  server:
    container_name: server
    build: ../server
    restart: always
    environment:
      - PORT=8081
      - REGISTRY_URL=http://registry-backend:8001
    ports:
      - "8081:8081"

  # registry
  registry-frontend:
    container_name: registry-frontend
    image: borksson/registry-frontend
    restart: always
    ports:
      - "3001:3000"

  registry-backend:
    container_name: registry-backend
    image: borksson/registry-backend
    restart: always
    environment:
      - PORT=8001
    ports:
      - "8001:8001"
    volumes:
      - ../secrets:/usr/src/app/secrets


secrets:
  # Postgres
  POSTGRES_PASSWORD:
    file: ../secrets/postgres-password.txt
